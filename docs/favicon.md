# Favicon

Ahh, the good old small icon in your browser tab representing your website. So the user has another visual clue to switch tabs. It appears in the search results as well.

It used to be as simple as converting your icon to `.ico` and placing it as `favicon.ico` in the root of your
website (`/favicon.ico`).

However, later it was recommended to point at it using a `<link rel="icon">` HTML tag. Then, PWAs arrived and you could
specify icons for them. Apple and its touch icons if you add the site to your phone's home screen...

I used to use a favicon generator site called [FaviconGenerator.org] but there are quite a few. Why is this one better? At that time, because it generated all the extra jazz (Apple touch icons, Android icons,
Microsoft tiles...). But after taking a look, it seems it misses some things after checking in [some favicon checker sites](#checkers).

Eventually came with [a 2021 article](https://www.leereamsnyder.com/blog/favicons-in-2021) talking about the topic that
lead me to a [2023 updated article](https://dev.to/masakudamatsu/favicon-nightmare-how-to-maintain-sanity-3al7) which
seems quite comprehensive.

So using that guide, generated the favicons. Eventually, I designed the favicon using Inkscape in a 512x512 size (the biggest required from what I've seen). And exported it using SVG.

Font is the monospace font of the site. Color is one with 50% luminance in the HSL scale. Took it from the color palette of the default theme. This way it looks
with [sufficient contrast](https://coolors.co/contrast-checker/) disregarding if the text is displayed
against a dark or light background. Then theme color is `neutral15` as I like more the dark mode. And that color is the main background one for dark mode.

Finally, used some generators and checkers to ensure I'm not missing any important icon.

# Included favicons

## Basic

First, added the main icons given by [Real Favicon Generator]. Trust them as they seem quite focused on icons should be included. Gets updated from time to time.

```html
<link rel="icon" type="image/png" href="/images/favicons/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-touch-icon.png" />
<meta name="apple-mobile-web-app-title" content="davidlj95" />
<link rel="manifest" href="/manifest.json" />
```

- [`favicon.svg`](/public/favicon.svg): is the [original one ](/assets/favicon_inkscape.svg). With some optimizations. Exported as "Optimized SVG" from Inkscape. Compressed with `pnpm dlx svgo favicon.svg`.

- [`favicon.ico`](/public/favicon.ico): is generated from [Favicomatic][favicomatic]. Given seems that includes multiple sizes in the
  same file (`16`, `24`, `32`, `48` and `64`). You can [open the file with GIMP to know how many sizes the ICO file contains](https://askubuntu.com/a/1440219/605666)

## Theme color

Not 100% strictly related to favicons. But here it is. Also defined for Microsoft tiles and progressive web apps via the web manifest.

```html
<meta name="theme-color" content="#282828" />
```

## Apple touch icons

For all sizes. Which at the moment of writing this means a squared icon of:

- 57
- 114
- 72
- 144
- 60
- 120
- 76
- 152

pixels

With its related HTML links:

```html
<link rel="apple-touch-icon-precomposed" sizes="57x57" href="/images/favicons/apple-touch-icon-57x57.png" />
```

Generated by [Favicomatic]. Apocalypse mode. The order of sizes is also because of their generator.

## Extra favicon sizes

Then, some extra favicon sizes, provided by [Favicomatic] in apocalypse mode.

Sizes:

- 196
- 96
- 32
- 16
- 128

With HTML link tags in the fashion of:

```html
<link href="assets/favicons/favicon-196x196.png" rel="icon" sizes="196x196" type="image/png" />
```

I first used the ones by [FaviconGenerator.org]. But they miss the 196, 128 version and are ordered differently. Also, [Favicomatic] ones are lighter.

> The 196 version fixed the "Android M31" test in [Favicometer]

# Web manifest

Was linked in the [basic](#basic) section.

Added maskable icons

```json
{
  "src": "images/favicons/maskable-icon-x48.png",
  "sizes": "48x48",
  "type": "image/png",
  "purpose": "any maskable monochrome"
}
```

Provided by [Maskable.app](https://maskable.app). That bit of JSON was typed by myself, using the [`icons` member MDN docs of web manifests](https://developer.mozilla.org/en-US/docs/Web/Manifest/icons). An extra
one with no size is included as default.

The `"any maskable"` purpose comes from a [web.dev docs recommendation](https://web.dev/add-manifest/#icons). Later
added `monochrome` too so that can be used for `monochrome` purposes (it looks good after testing it
in [monochrome.fyi](https://monochrome.fyi))

> Previously, I had used the ones generated by [FaviconGenerator.org]. However, those use `size`
> and `density` properties inside the manifest's `icon` property. Which is not documentedü§î Maybe that got obsolete? The
> manifest generated by [RealFaviconGenerator] also uses `src` + `sizes` + `type` and no `density` or `size` (in singular) at all.

> [!NOTE]
> When opening the DevTools `Application` tab, a message appears about those icons. `any maskable` is discouraged. However, is good enough for us.

## Microsoft tiles

A [`browserconfig.xml`](/public/browserconfig.xml) file is created to provided tiles for legacy Windows Phone and Microsoft 8/10 tiles.

Includes icon in sizes:

- 70x70
- 150x150
- 310x310
- 310x150

Those icons are created by [Favicomatic]. However, the file code is
from [FaviconGenerator.org]. Given [Favicomatic] puts the code as `meta` tags in
the `index.html` `head` tag. But I find having a separate `browserconfig.xml` file better, to keep the index cleaner and lighter.
This also avoids offering info that may not be needed (you don't care at all about tiles if using macOS + Chrome for instance).

> Both [Favicomatic] and [FaviconGenerator.org] generate the same sizes of icons.
> However, [Favicomatic] includes a wide tile. That one is added manually in the `browserconfig.xml` from the shape of the `meta` tag that [Favicomatic] provides.

However, as per [Favicometer], seems that at least the tile app, color and image are needed for IE10 pinned
sites. So we need a bit more tags in our `index.html`

```html
<meta name="msapplication-TileColor" content="#282828" />

<meta name="msapplication-TileImage" content="/images/favicons/mstile-144x144.png" />
```

Check [Microsoft docs](<https://learn.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/samples/dn455106(v=vs.85)?redirectedfrom=MSDN>)
for more info.

# SVG optimisations

## `text` to `path`

In my Android's device Chrome browser, the text in the SVG was overflowing the `viewBox`. Seems because a font rendering issue. I'm
suspecting because SVG's font isn't available, then another font is used. Therefore, sizes do not match. So converted texts into paths to ensure consistent rendering across devices.

In Inkscape, the source file has both texts and paths. Had to manually remove the texts from the generated SVG. Despite those being hidden in Inkscape, it exports them anyway.

# Generators

I've used:

- [RealFaviconGenerator]
- [`Favic-o-matic`][Favicomatic]. Doesn't support SVGüò¢ Doesn't generate the `.webmanifest`
- [FaviconGenerator.org]. Doesn't allow SVGs üò¢

## Discarded

- [Favicon.cc](https://www.favicon.cc/). üïπÔ∏è Allows designing a 16x16 one only. Retro-ish.
- [Favicon.ico](https://favicon.io/favicon-converter/). Misses ability to customize maskable icons for Android/iOS.

# Checkers

- [`Favic-o-matic`'s `favic-o-meter`][Favicometer]
- [RealFaviconGenerator checker]

# Notes

- Removed Safari masked icon as [RealFaviconGenerator] no longer includes it. (`rel="mask-icon" href="safari-pinned-tab.svg" color="#282828"`).
- Application name is now specified in metas using `ngx-meta`
- Removed light/dark `style` in the `svg`. As given that the site may change due to forcing dark/light, then the color would not respect that. So leaving just one color and that's it. Also simplifies things.

[FaviconGenerator.org]: https://www.favicon-generator.org/
[Favicomatic]: https://favicomatic.com/
[RealFaviconGenerator]: https://realfavicongenerator.net/
[RealFaviconGenerator checker]: https://realfavicongenerator.net/favicon-checker
[Favicometer]: https://favicomatic.com/favicon-test
